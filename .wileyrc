#!/bin/bash

# add this to the bashrc
#if [ -f ~/.wileyrc ]; then
#  . ~/.wileyrc
#fi
  
# If not running interactively, don't do anything
[ -z "$PS1" ] && return

#keychain -q id_rsa testing_rsa

export PS1="\[\e[1;32m\][\u@\h \W\[\e[1;33m\]\$(git branch 2> /dev/null | grep -e '\* ' | sed 's/^..\(.*\)/{\1}/')\[\e[1;32m\]]\$\[\e[0m\] "

stty -ctlecho

# enable color support of ls and also add handy aliases
if [ -x /usr/bin/dircolors ]; then
  eval "`dircolors -b`"
  alias ls='ls --color=auto'
  alias grep='grep --color=auto'
  alias fgrep='fgrep --color=auto'
  alias egrep='egrep --color=auto'
fi

# set PATH so it includes user's private bin if it exists
if [ -d "$HOME/bin" ] ; then
    PATH="$HOME/bin:$PATH"
fi

_memuseImpl() {
  /bin/ps -u $(whoami) -o pid,rss,command | awk '{sum+=$2} END {print "Total " sum / 1024 " MB"}';
}

_git_hall_of_fame_impl() {
git ls-files -z | xargs -0n1 git blame -w | ruby -n -e '$_ =~ /^.*?\((.*?)\s[\d]{4}/; puts $1.strip' | sort -f | uniq -c | sort -n
}

# no one touches but me
umask 077

export EDITOR=vim

alias ll='ls -l'
alias la='ls -A'
alias l='ls -CF'
alias v=vim
alias vi=vim
alias vim='vim -O'
alias vimrc="vim ~/.vimrc"
alias bashrc="vim ~/.bashrc"

alias gg='git grep'
alias gb='git branch'
alias gc='git checkout'
alias gs='git status'
alias gr='git rev-parse --show-toplevel'
# Git hall of fame
alias git-hof=_git_hall_of_fame_impl

alias tm='tmux'
alias tmux='TERM=xterm-256color tmux'
alias tmcp='tmux show-buffer | xsel -pb'

alias mem=_memuseImpl

if [ -f "${HOME}/.corp_rc" ]; then
  . "${HOME}/.corp_rc"
fi
